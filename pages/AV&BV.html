<!DOCTYPE html>
<html lang="zh">
<head>
    <link rel="stylesheet" href="/resources/css/style.css"/>
    <link rel="icon" href="/resources/icon.png" type="image/png">
    <link rel="shortcut icon" href="/resources/icon.png" type="image/png">
    <meta name="apple-touch-icon" content="/resources/icon.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AV号BV号互转</title>
</head>
<body>

<div id="ambient"></div>
<script src="/resources/js/bvambient.js"></script>
<script src="/resources/js/randompics.js"></script>

<div class="card-wrapper">
    <div class="card">
        <div class="card-back">



            <h1>AV号BV号互转</h1>

            <!-- 解码部分 -->

            <div class="input-group">
                <label for="AVInput">请输入AV号：</label>
            </div>
            <div class="input-group">

                <input type="text" id="AVInput" placeholder="882584971">
                <button onclick="convertToBV()">转BV并复制</button>
            </div>

            <!-- 编码部分 -->
            <div class="input-group">
                <label for="BVInput">请输入BV号：</label>
            </div>
            <div class="input-group">
                <input type="text" id="BVInput" placeholder="BV1mK4y1C7Bz">
                <button onclick="convertToAV()">转AV并复制</button>
            </div>
            <button onclick="location.href='/index.html'">回到主页</button>


        </div>
        <div class="card-front">
            <img id="randomImage" src="/resources/icon.png" alt="随机图片">
            <div class="quote">Loading...</div>



        </div>
    </div>
</div>




<script>

    function convertToBV() {
        try {
            let x = document.getElementById("AVInput").value;
            x = (x ^ xor) + add;
            let r = ['B', 'V', '1', ' ', ' ', '4', ' ', '1', ' ', '7', ' ', ' '];
            for (let i = 0; i < 6; i++) {
                r[s[i]] = table[Math.floor(x / Math.pow(58, i)) % 58];
            }
            document.getElementById("BVInput").value = r.join('');
            copyToClipboard(r.join(''));
            return r.join('');
        } catch (e) {
            document.getElementById("BVInput").value = "无效的AV号";
        }
    }

    // JavaScript 函数：将 Base64 编码转换为原始文本
    function convertToAV() {
        try {
            let x = document.getElementById("BVInput").value;
            let r = 0;
            for (let i = 0; i < 6; i++) {
                r += tr[x[s[i]]] * Math.pow(58, i);
            }
            document.getElementById("AVInput").value = (r - add) ^ xor;
            copyToClipboard((r - add) ^ xor);
            return (r - add) ^ xor;
        } catch (e) {
            document.getElementById("AVInput").value = "无效的BV号";
        }
    }

    // JavaScript 函数：将内容复制到剪贴板
    function copyToClipboard(text) {
        var textarea = document.createElement("textarea");
        textarea.value = text; // 将要复制的文本赋值给 textarea
        document.body.appendChild(textarea); // 添加 textarea 到文档中
        textarea.select(); // 选中 textarea 中的文本
        document.execCommand("copy"); // 执行复制命令
        document.body.removeChild(textarea); // 从文档中移除 textarea
    }

    const table = 'fZodR9XQDSUm21yCkr6zBqiveYah8bt4xsWpHnJE7jL5VG3guMTKNPAwcF';
    const tr = {};
    for (let i = 0; i < 58; i++) {
        tr[table[i]] = i;
    }
    const s = [11, 10, 3, 8, 4, 6];
    const xor = 177451812;
    const add = 8728348608;


</script>
<a href="https://github.com/4evergr8/4evergr8.github.io" target="_blank">
    <img src="/resources/github-mark-white.png" alt="项目地址" id="GitHubIcon">
</a>

</body>
</html>
